<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Личный кабинет - Языковая школа "Полиглот"</title>
    <!-- bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="images/logo.png">
    <link rel="icon" href="images/logo.png" type="image/png" size="128x128">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- область уведомлений -->
    <div id="notification-area" class="position-fixed top-0 end-0 p-3" style="z-index: 1056;"></div>

    <!-- шапка -->
    <header class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="images/logo.png" alt="Логотип школы" height="40" class="d-inline-block align-text-top me-2">
                Академик
            </a>
            <nav>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">
                            <i class="bi bi-house-door"></i> На главную
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="logoutBtn">
                            <i class="bi bi-box-arrow-right"></i> Выйти
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- основной контент -->
    <main class="container my-5">
        <div class="row">
            <div class="col-12">
                <h1 class="mb-4">
                    <i class="bi bi-person-circle"></i> Личный кабинет
                </h1>
                
                <!-- статистика -->
                <div class="row mb-4">
                    <div class="col-md-3">
                        <div class="card bg-primary text-white">
                            <div class="card-body">
                                <h5 class="card-title">Активные заявки</h5>
                                <p class="card-text display-6" id="activeOrdersCount">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-success text-white">
                            <div class="card-body">
                                <h5 class="card-title">Завершённые</h5>
                                <p class="card-text display-6" id="completedOrdersCount">0</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-info text-white">
                            <div class="card-body">
                                <h5 class="card-title">Общая сумма</h5>
                                <p class="card-text display-6" id="totalAmount">0 ₽</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-warning text-white">
                            <div class="card-body">
                                <h5 class="card-title">Средний чек</h5>
                                <p class="card-text display-6" id="averageAmount">0 ₽</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="alert alert-warning" id="orderLimitAlert" style="display: none;">
                    <i class="bi bi-exclamation-triangle"></i>
                    <strong>Внимание:</strong> Вы использовали <span id="ordersUsed">0</span> из 10 доступных заявок.
                    <span id="limitWarningText"></span>
                </div>

                <!-- таблица заказов -->
                <div class="card shadow-sm">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">Мои заявки</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover" id="ordersTable">
                                <thead class="table-dark">
                                    <tr>
                                        <th>#</th>
                                        <th>Тип</th>
                                        <th>Название</th>
                                        <th>Дата занятия</th>
                                        <th>Время</th>
                                        <th>Кол-во человек</th>
                                        <th>Стоимость</th>
                                        <th>Статус</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersTableBody">
                                    <!-- заполняется через JS -->
                                </tbody>
                            </table>
                        </div>

                        <!-- сообщение при пустой таблице -->
                        <div id="emptyTableMessage" class="text-center py-5 d-none">
                            <i class="bi bi-inbox fs-1 text-muted"></i>
                            <h4 class="mt-3">У вас пока нет заявок</h4>
                            <p class="text-muted">Перейдите на главную страницу, чтобы оформить первую заявку</p>
                            <a href="index.html" class="btn btn-primary mt-2">
                                <i class="bi bi-plus-circle"></i> Создать заявку
                            </a>
                        </div>

                        <!-- пагинация -->
                        <nav id="ordersPagination" class="mt-4">
                            <ul class="pagination justify-content-center">
                                <!-- генерируется через JS -->
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- футер -->
    <footer class="bg-dark text-white py-5 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <h5>Языковая школа "Полиглот"</h5>
                    <p><i class="bi bi-geo-alt"></i> Москва, ул. Образцова, 15</p>
                    <p><i class="bi bi-phone"></i> +7 (999) 123-45-67</p>
                    <p><i class="bi bi-envelope"></i> info@polyglot-school.ru</p>
                </div>
                <div class="col-md-4">
                    <h5>Поддержка</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white text-decoration-none">FAQ</a></li>
                        <li><a href="#" class="text-white text-decoration-none">Политика конфиденциальности</a></li>
                        <li><a href="#" class="text-white text-decoration-none">Условия использования</a></li>
                        <li><a href="#" class="text-white text-decoration-none">Техническая поддержка</a></li>
                    </ul>
                </div>
                <div class="col-md-4">
                    <h5>Социальные сети</h5>
                    <div class="social-links">
                        <a href="#" class="text-white me-3"><i class="bi bi-facebook fs-4"></i></a>
                        <a href="#" class="text-white me-3"><i class="bi bi-vk fs-4"></i></a>
                        <a href="#" class="text-white me-3"><i class="bi bi-telegram fs-4"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-youtube fs-4"></i></a>
                    </div>
                </div>
            </div>
            <hr class="bg-light">
            <p class="text-center mb-0">&copy; 2025 Языковая школа "Полиглот". Все права защищены.</p>
        </div>
    </footer>

    <!-- модальное окно подробностей -->
    <div class="modal fade" id="detailModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Детали заявки #<span id="detailOrderId"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Основная информация</h6>
                            <p><strong>Тип:</strong> <span id="detailType"></span></p>
                            <p><strong>Название:</strong> <span id="detailName"></span></p>
                            <p><strong>Дата:</strong> <span id="detailDate"></span></p>
                            <p><strong>Время:</strong> <span id="detailTime"></span></p>
                            <p><strong>Кол-во человек:</strong> <span id="detailPersons"></span></p>
                        </div>
                        <div class="col-md-6">
                            <h6>Стоимость</h6>
                            <p><strong>Базовая цена:</strong> <span id="detailBasePrice"></span> ₽</p>
                            <p><strong>Скидки/надбавки:</strong></p>
                            <ul id="detailDiscounts" class="list-unstyled">
                                <!-- заполняется динамически -->
                            </ul>
                            <p class="fs-5"><strong>Итого:</strong> <span id="detailTotalPrice" class="text-success"></span> ₽</p>
                        </div>
                    </div>
                    <div class="mt-3">
                        <h6>Дополнительные опции</h6>
                        <div id="detailOptions" class="row">
                            <!-- заполняется динамически -->
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>

    <!-- модальное окно редактирования -->
    <div class="modal fade" id="editModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Редактирование заявки #<span id="editOrderId"></span></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="editOrderForm">
                        <input type="hidden" id="editId">
                        
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label">Дата занятия *</label>
                                <input type="date" class="form-control" id="editDate" required>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Время занятия *</label>
                                <input type="time" class="form-control" id="editTime" required>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Количество человек (1-20) *</label>
                            <input type="number" class="form-control" id="editPersons" min="1" max="20" required>
                        </div>
                        
                        <h6 class="mt-4">Дополнительные опции</h6>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="editEarlyRegistration">
                                    <label class="form-check-label" for="editEarlyRegistration">
                                        Скидка за раннюю регистрацию (10%)
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="editGroupEnrollment">
                                    <label class="form-check-label" for="editGroupEnrollment">
                                        Групповая скидка (15% от 5+ человек)
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="editIntensiveCourse">
                                    <label class="form-check-label" for="editIntensiveCourse">
                                        Интенсивный курс (+20%)
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="editSupplementary">
                                    <label class="form-check-label" for="editSupplementary">
                                        Доп. материалы (+2000 ₽ на человека)
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="editPersonalized">
                                    <label class="form-check-label" for="editPersonalized">
                                        Индивидуальные занятия (+1500 ₽/неделю)
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="editExcursions">
                                    <label class="form-check-label" for="editExcursions">
                                        Культурные экскурсии (+25%)
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="editAssessment">
                                    <label class="form-check-label" for="editAssessment">
                                        Оценка уровня (+300 ₽)
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="editInteractive">
                                    <label class="form-check-label" for="editInteractive">
                                        Интерактивная платформа (+50%)
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="alert alert-info mt-3">
                            <i class="bi bi-info-circle"></i> Итоговая стоимость будет пересчитана автоматически после сохранения
                        </div>
                        
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
                            <button type="submit" class="btn btn-primary">Сохранить изменения</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- модальное окно подтверждения удаления -->
    <div class="modal fade" id="deleteModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Подтверждение удаления</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p>Вы уверены, что хотите удалить заявку #<span id="deleteOrderId"></span>?</p>
                    <p class="text-danger"><i class="bi bi-exclamation-triangle"></i> Это действие нельзя отменить.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Нет, отмена</button>
                    <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Да, удалить</button>
                </div>
            </div>
        </div>
    </div>

    <!-- bootstrap JS + popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- JS личного кабинета -->
    <script src="js/api.js"></script>
    <script src="js/cabinet.js"></script>
</body>
</html>
